#!/bin/sh
# Pre-commit hook: sync README from User/README.md before commit
# This script is stored in repository at githooks/pre-commit; use scripts/install-git-hooks.ps1 to install into .git/hooks

REPO_ROOT="$(git rev-parse --show-toplevel)"

if command -v pwsh >/dev/null 2>&1; then
  pwsh -NoProfile -ExecutionPolicy Bypass -File "$REPO_ROOT/scripts/sync_readme.ps1"
elif command -v powershell >/dev/null 2>&1; then
  powershell -NoProfile -ExecutionPolicy Bypass -File "$REPO_ROOT/scripts/sync_readme.ps1"
else
  echo "PowerShell not found; skipping README sync"
fi

# If README changed, stage it (sync_readme.ps1 already does git add; this is just a fallback)
git add README.md || true
